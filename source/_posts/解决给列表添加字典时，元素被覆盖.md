---
title: 解决给列表添加字典时，元素被覆盖问题
date: 2022-01-09 10:51:04.857
updated: 2022-01-09 11:15:57.595
url: /?p=139
categories: 
- 后端
tags: 
- Python
---

## 准备素材
```python
# 字典
{'id': 1, 'name': 1},
{'id': 2, 'name': 2}, 
{'id': 2, 'name': 3}, 
{'id': 4, 'name': 4},

```
## 错误代码
```python
li = []
dic = {}
for i in range(1, 5):
    dic["id"] = i
    dic["name"] = i
    li.append(dic)

print(li)
# 结果
[{'id': 4, 'name': 4}, {'id': 4, 'name': 4}, {'id': 4, 'name': 4}, {'id': 4, 'name': 4}]
```
## 方案一   
<font style="color:red">使用item.copy()</font>
```python
li = []
dic = {}
for i in range(1, 5):
    dic["id"] = i
    dic["name"] = i
    li.append(dic.copy())

print(li)
# 结果
[{'id': 1, 'name': 1}, {'id': 2, 'name': 2}, {'id': 3, 'name': 3}, {'id': 4, 'name': 4}]
```
<font style="color:red">使用copy.deepcopy(item)</font>
```python
from copy import deepcopy
li = []
dic = {}
for i in range(1, 5):
    dic["id"] = i
    dic["name"] = i
    li.append(deepcopy(dic))

print(li)
# 结果
[{'id': 1, 'name': 1}, {'id': 2, 'name': 2}, {'id': 3, 'name': 3}, {'id': 4, 'name': 4}]
```

## 方案二   
<font style="color:red">赋值新的字典对象</font>
```python
li = []

for i in range(1, 5):
    dic = {}
    dic["id"] = i
    dic["name"] = i
    li.append(dic)

print(li)
# 结果
[{'id': 1, 'name': 1}, {'id': 2, 'name': 2}, {'id': 3, 'name': 3}, {'id': 4, 'name': 4}]
```